<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <table class="table table-hover">
        <tbody id="my_data">

            <tr>
                <th>#ID</th>
                <th>First Name</th>
                <th>Last Name</th>

                <th>City</th>
                <th>A/c Number</th>
                <th>Addhar Number</th>
                <th>Store Data</th>

            </tr>

            <% for(let i=0; i<ans.length; i++) { %>
                <tr id="t<%= ans[i].id %>">
                    <th scope="row">
                        <input type="text" name=" <%`id${i}`%>" value="<%= ans[i].id %>" readonly>

                    </th>

                    <td>
                        <input type="text" name="<%`fname${i}`%>" value="<%= ans[i].fname %>">


                    </td>
                    <td><input type="text" name="<%`lname${i}`%>" value="<%= ans[i].lname %>"> </td>
                    <td>
                        <input type="text" name="<%`city${i}`%>" value="<%= ans[i].city %>">
                    </td>
                    <td>
                        <input type="text" name="<%`acc_no${i}`%>" value="<%= ans[i].account_no%>">
                    </td>
                    <td>
                        <input type="text" name="<%`addhar_no${i}`%>" value="<%= ans[i].addhar_no %>">
                    </td>

                    <td><span><i id="<%= ans[i].id %>" class="bi bi-eye-fill" onclick="handleSave(this)">Save</i></span>
                    </td>
                </tr>
                <% } %>
                <div class="linkss">
    
                    <a id="Link" onclick="addRow()">Add Row</a>
               
            </div>
        </body>

        </tbody>
    </table>
   
<script>
    async function handleSave(ele) {
        console.log("i am here");
        const id = ele.id
        console.log(id);
        alert("Do you want to save data ?")
        const save_req = await fetch(`http://localhost:5003/save/${id}`);
        var resSave = await save_req.json();
        console.log(resSave);

        if (resSave) {
            alert("Your Data is Stored Successfully ")
        }
    }

    async function addRow() {
        console.log("he bab");
        const response = await fetch('/getId');
        const data = await response.json();
        console.log(data);
        const id = data.ans[0].id + 1;
        console.log("i got data");
        let content = `<tr id="Table_row1"> 
                    <td><input type="text" value="${id}" name="id${id}" id="input1" readonly></td>
                    <td><input type="text" name="first_name${id}" id="input1"></td>
                    <td><input type="text" name="last_name${id}" id="input2"></td>
                    <td><input type="text" name="city${id}" id="input3"></td>
                    <td><input type="text" name="A/c_no${id}" id="input4"></td>
                    <td><input type="text" name="addhar_no${id}" id="input5"></td>
                    <<p class="btn btn-success" onclick="handleSave(this)">save</p>
            </tr>`;

        const div = document.createElement('div');
        div.innerHTML = content;
          let tbody = document.getElementById('my_data')
        tbody.appendChild(div)

    }



</script>

</html>